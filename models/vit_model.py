# models/vit_model.py
import torch
from torchvision.models import vit_b_16

class ViTModel(torch.nn.Module):
    def __init__(self, pretrained=True):
        super(ViTModel, self).__init__()
        self.model = vit_b_16(pretrained=True)
        self.model.head = torch.nn.Identity()  # Modify last layer for feature extraction

    def forward(self, x):
        # Move input tensor to the same device as model parameters
        x = x.to(next(self.parameters()).device)
        return self.model(x)
