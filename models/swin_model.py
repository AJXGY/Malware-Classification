# models/swin_model.py
import torch
from torchvision.models import swin_transformer

class SwinTransformerModel(torch.nn.Module):
    def __init__(self, pretrained=True):
        super(SwinTransformerModel, self).__init__()
        self.model = swin_transformer.swin_v2_b(pretrained=True)
        self.model.head = torch.nn.Identity()  # Modify last layer for feature extraction

    def forward(self, x):
        # Move input tensor to the same device as model parameters
        x = x.to(next(self.parameters()).device)
        return self.model(x)