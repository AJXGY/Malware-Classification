# models/vgg_model.py
import torch
from torchvision.models import vgg16

class VGGModel(torch.nn.Module):
    def __init__(self, pretrained=True):
        super(VGGModel, self).__init__()
        self.model = vgg16(pretrained=pretrained)
        self.model.classifier = torch.nn.Identity()  # Modify last layer for feature extraction

    def forward(self, x):
        # Move input tensor to the same device as model parameters
        x = x.to(next(self.parameters()).device)
        return self.model(x)
