# models/resnet_model.py
import torch
from torchvision.models import resnet18

class ResNetModel(torch.nn.Module):
    def __init__(self, pretrained=True):
        super(ResNetModel, self).__init__()
        self.model = resnet18(pretrained=pretrained)
        self.model.fc = torch.nn.Identity()  # Modify last layer for feature extraction

    def forward(self, x):
        # Move input tensor to the same device as model parameters
        x = x.to(next(self.parameters()).device)
        return self.model(x)
